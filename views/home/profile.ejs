<!DOCTYPE html>
<html lang="en">
<%- include('../includes/header'); -%>

    <body>
        <%- include('../includes/navbar'); -%>
            <!-- Page Header -->
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <!-- Page title -->
                        <div class="my-5">
                            <h3>My Profile</h3>
                            <hr>
                        </div>
                        <!-- Form START -->
                        <form method="POST" action="/update-profile" class="file-upload">
                            <div class="row gx-5">
                                <!-- Upload profile -->
                                <div class="col-xxl-4 mb-5">
                                    <div class="bg-secondary-soft px-4 py-5 rounded">
                                        <div class="row g-3">
                                            <h4 class="mb-4 mt-0">Upload your profile photo</h4>
                                            <div class="text-center">
                                                <!-- Image upload -->
                                                <div class="square position-relative display-2 mb-3">
                                                    <div id="avatar-preview"><img src="<% if (info.avatar == null) {
                                                        %>/img/no-avatar.jpg<%} else {%>upload/<%= info.avatar%><%}%>" alt="avatar" class="img-fluid rounded"></div>
                                                        <!-- handle update infomation but image is empty -->
                                                        <input type="text" value="<%= info.avatar%>"  class="form-control" name="avatar" hidden>
                                                </div>
                                                <!-- Button -->
                                                <input type="file" id="customFile" name="image" accept="image/*" hidden="" onchange="previewImage()">
                                                <label class="btn btn-success-soft btn-block"
                                                    for="customFile">Upload</label>
                                                <button type="button" class="btn btn-danger-soft" onclick="removeImage()">Remove</button>
                                                <!-- Content -->
                                                <p class="text-muted mt-3 mb-0"><span class="me-1">Note:</span>Photo size 2x3</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Profile detail -->
                                <div class="col-xxl-8 mb-xxl-0">
                                    <div class="bg-secondary-soft px-4 py-5     rounded">
                                        <div class="row g-3 mb-5">
                                            <h4 class="mb-4 mt-0">Profile detail</h4>
                                            <!-- First Name -->
                                            <div class="col-md-6">
                                                <label class="form-label">First Name *</label>
                                                <input type="text" class="form-control" placeholder="Nguyen Hai"
                                                    aria-label="First name" name="first_name" value="<%= info.first_name%>">
                                            </div>
                                            <!-- Last name -->
                                            <div class="col-md-6">
                                                <label class="form-label">Last Name *</label>
                                                <input type="text" class="form-control" placeholder="Minh"
                                                    aria-label="Last name" name="last_name" value="<%= info.last_name%>">
                                            </div>
                                            <!-- Phone number -->
                                            <div class="col-md-6">
                                                <label class="form-label">Phone number *</label>
                                                <input type="text" class="form-control" placeholder="0827050981"
                                                    aria-label="Phone number" name="phone" value="<%= info.phone%>">
                                            </div>
                                            <!-- Address -->
                                            <div class="col-md-6">
                                                <label class="form-label">Address *</label>
                                                <input type="text" class="form-control" placeholder="Hai Duong Viet Nam"
                                                    aria-label="Address" name="address" value="<%= info.address%>">
                                            </div>
                                            <!-- Email -->
                                            <div class="col-md-6">
                                                <label for="inputEmail4" class="form-label">Email *</label>
                                                <input type="email" class="form-control" name="email" id="inputEmail4"
                                                    value="<%= info.email%>">
                                            </div>
                                            <!-- Date of birth -->
                                            <div class="col-md-6">
                                                <label for="inputEmail4" class="form-label">Date of birth *</label>
                                                <input type="date" class="form-control" name="dob" value="<%= info.dob%>">
                                            </div>                                            
                                        </div>
                                        <!-- Button -->
                                        <div class="gap-3 d-md-flex justify-content-md-end mb-5">
                                            <a href="/delete-account"><button type="button" class="btn btn-danger">Delete profile</button></a>
                                            <button type="submit" class="btn btn-success">Update profile</button>
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- Row END -->
                    </div>
                </div>
                </form> <!-- Form END -->
                <hr>

                <!-- Change password -->
                <form method="POST" action="/change-password">
                    <!-- change password -->
                    <div class="bg-secondary-soft px-4 py-5 rounded">
                        <div class="row g-3">
                            <h4 class="my-4">Change Password</h4>
                            <!-- Old password -->
                            <div class="col-md-6">
                                <label for="exampleInputPassword1" class="form-label">Old
                                    password
                                    *</label>
                                <input type="password" class="form-control" name="old_password"
                                    id="exampleInputPassword1">
                            </div>
                            <!-- New password -->
                            <div class="col-md-6">
                                <label for="exampleInputPassword2" class="form-label">New
                                    password
                                    *</label>
                                <input type="password" class="form-control" name="new_password"
                                    id="exampleInputPassword2">
                            </div>
                            <!-- Confirm password -->
                            <div class="col-md-12">
                                <label for="exampleInputPassword3" class="form-label">Confirm
                                    Password
                                    *</label>
                                <input type="password" class="form-control" name="confirm_password"
                                    id="exampleInputPassword3">
                            </div>
                        </div>
                        <!-- Button -->
                        <div class="gap-3 mt-5 d-md-flex justify-content-md-end mb-5 me-5">
                            <button type="submit" class="btn btn-success">Change Password</button>
                        </div>
                    </div> <!-- Row END -->
                </form>
            </div> <!-- Container END -->

            <!-- Main Content -->
            <%- include('../includes/scripts'); -%>
                <%- include('../includes/footer'); -%>

                <script>
                    function previewImage() {
                      var fileInput = document.getElementById("customFile");
                      var preview = document.getElementById("avatar-preview");
              
                      if (fileInput.files && fileInput.files[0]) {
                        var reader = new FileReader();
              
                        reader.onload = function (e) {
                          preview.innerHTML =
                            '<img src="' + e.target.result + '" alt="Preview" class="img-fluid rounded">';
                        };
              
                        reader.readAsDataURL(fileInput.files[0]);
                      }
                    }
                    function removeImage() {
                        var avatarPreview = document.getElementById('avatar-preview');
                        avatarPreview.innerHTML = '<img src="/img/no-avatar.jpg" alt="avatar" class="img-fluid rounded">';
                        // You can also reset the input field value if needed
                        document.getElementById('customFile').value = '';
                    }
                  </script>
    </body>

</html>